<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Join Collaborative Editor</title>
</head>
<body>
<h1>Join Collaborative Editor</h1>
<form id="session-form">
    <label>Username: <input type="text" id="username" required></label><br>
    <label>Color: <input type="color" id="color" required></label><br>
    <label>Session ID: <input type="text" id="session-id" placeholder="Leave empty to generate"></label><br>
    <button type="submit">Join</button>
</form>

<script>
    document.getElementById("session-form").addEventListener("submit", function (e) {
        e.preventDefault();
        const username = document.getElementById("username").value;
        const color = document.getElementById("color").value;
        let sessionId = document.getElementById("session-id").value;

        // If no sessionId is provided, generate one
        if (!sessionId) {
            sessionId = 'session-' + Math.random().toString(36).substring(2, 10);
        }

        // Validate session ID format
        if (!isValidSessionId(sessionId)) {
            alert("Invalid session ID format. Please follow the format: alphanumeric, dash, or underscore, 6-12 characters.");
            return;
        }

        // Attempt to join the session
        window.location.href = `/editor.html?session=${sessionId}&user=${encodeURIComponent(username)}&color=${encodeURIComponent(color)}`;
    });

    function isValidSessionId(sessionId) {
        // Match the same regex from the server
        const regex = /^session-[a-zA-Z0-9_-]{6,12}$/;
        return regex.test(sessionId);
    }
</script>
</body>
</html>
